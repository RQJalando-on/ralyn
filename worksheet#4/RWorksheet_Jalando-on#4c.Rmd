---
title: "RWorksheet_Jalando-on#4c"
author: "Ralyn Queen Jalando-on"
date: "2024-11-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
1. Use the dataset mpg
A data frame with 234 rows and 11 variables:
a. Show your solutions on how to import a csv file into the environment.
```{r}
mpgData <- read.csv("mpg.csv")
mpgData
```
b. Which variables from mpg dataset are categorical?

**Manufacturer, drv, cyl, model, trans, fl, class**

c. Which are continuous variables?

**dsipl, year, cyt, hwy**

2. Which manufacturer has the most models in this data set? Which model has the most variations?
Show your answer.
```{r}
library(dplyr)

manufacturersCount <- mpgData %>%
  group_by(manufacturer) %>%
  summarise(modelCount = n_distinct(model), .groups = 'drop') %>%
  arrange(desc(modelCount))

mostModelsManufacturer <- manufacturersCount %>% slice(1)

mostVariationCount <- mpgData %>%
  group_by(model) %>%
  summarise(variationCount = n(), .groups = 'drop') %>%
  arrange(desc(variationCount))
mostVariationModel <- mostVariationCount %>% slice(1)

mostModelsManufacturer 
mostVariationModel

```
a. Group the manufacturers and find the unique models. Show your codes and result.
```{r}
uniqueModels <- mpgData %>%
  group_by(manufacturer) %>%
  summarise(uniqueModels = list(unique(model))) %>%
  arrange(manufacturer)

uniqueModels
  
```

b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}
modelCounts <- mpgData %>%
  group_by(manufacturer) %>%
  summarise(uniqueModelCount = n_distinct(model)) %>%
  arrange(desc(uniqueModelCount))

barplot(modelCounts$uniqueModelCount,
        names.arg = modelCounts$manufacturer,
        las = 2,
        col = "#FFE8E1",
        main = "Number of Unique Models by Manufacturer",
        xlab = "Manufacturer",
        ylab = "Number of Unique Models")

library(ggplot2)

ggplot(modelCounts, aes(x = reorder(manufacturer, uniqueModelCount), y = uniqueModelCount)) + 
  geom_bar(stat = "identity", fill = "#FFE8E1") + 
  coord_flip() + labs(title = "Number of Unique Models by Manufacturer", 
                      x = "Manufacturer", 
                      y = "Number of Unique Models") + 
  theme_minimal()

```
2. Same dataset will be used. You are going to show the relationship of the model and the manufacturer.
a. What does ggplot(mpg, aes(model, manufacturer)) + geom_point() show?
```{r}
UniqueModels <- mpgData %>%
  group_by(manufacturer) %>%
  summarise(uniqueModels = list(unique(model))) %>%
  arrange(manufacturer)

uniqueModels
```

b. For you, is it useful? If not, how could you modify the data to make it more informative?
```{r}
modelCounts <- mpgData %>%
  group_by(manufacturer) %>%
  summarise(uniqueModelCount = n_distinct(model)) %>%
  arrange(desc(uniqueModelCount))

barplot(modelCounts$uniqueModelCount, 
        names.arg = modelCounts$manufacturer, 
        las = 2, 
        col = "#A10702", 
        main = "Number of Unique Models by Manufacturer",
        xlab = "Manufacturer", 
        ylab = "Number of Unique Models")


library(ggplot2)

ggplot(modelCounts, aes(x = reorder(manufacturer, uniqueModelCount), y = uniqueModelCount)) +
  geom_bar(stat = "identity", fill = "#A10702") +
  coord_flip() +
  labs(title = "Number of Unique Models by Manufacturer", 
       x = "Manufacturer", 
       y = "Number of Unique Models") +
  theme_minimal()

```

3. 
